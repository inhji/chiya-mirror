<!DOCTYPE html>
<html lang="en" style="scrollbar-gutter: stable;" data-theme={@settings.theme}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="csrf-token" content={get_csrf_token()} />
    <.live_title suffix={" Â· #{@settings.title}"}>
      <%= assigns[:page_title] || "Home" %>
    </.live_title>

    <.favicon />

    <link rel="authorization_endpoint" href={@auth_endpoint} />
    <link rel="token_endpoint" href={@token_endpoint} />
    <link rel="micropub" href={~p"/indie/micropub"} />

    <%= for identity <- @identities do %>
      <link rel="me" href={identity.url} />
    <% end %>

    <link rel="preconnect" href="https://rsms.me/" />
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />
    <link phx-track-static rel="stylesheet" href={~p"/assets/app.css"} />
    <script defer phx-track-static type="text/javascript" src={~p"/assets/public.js"}>
    </script>
    <script>
      if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.dataset["mode"] = "dark"
      } else {
        delete document.documentElement.dataset["mode"]
      }
    </script>
    <style>
      <%= @settings.custom_css %>
    </style>
  </head>
  <body class="bg-theme-background mx-3 md:mx-0">
    <header class="mt-8 max-w-xl mx-auto">
      <nav>
        <ul class="flex gap-3">
          <li>
            <a
              href="/"
              class="text-theme-base px-3 py-2.5 border border-theme-background1 hover:bg-theme-background1 rounded transition font-semibold"
            >
              <.icon name="hero-home" /> Home
            </a>
          </li>
        </ul>
      </nav>
    </header>

    <main>
      <%= @inner_content %>
    </main>

    <footer class="mx-auto max-w-xl mt-8 mb-8 text-theme-base/75 border-t pt-8 border-theme-background1">
      <p>
        <span>Served by Chiya v<%= Application.spec(:chiya, :vsn) %></span>
        <.dot />
        <span>Made by Inhji</span>
        <.dot />
        <span>Struggling to make a decent website since 2011</span>
      </p>

      <p>
        <%= for identity <- @public_identities do %>
          <span><a href={identity.url}><%= identity.name %></a></span>
          <.dot />
        <% end %>
        <span><a href={~p"/note/about"}>About</a></span>
        <.dot />
        <span><a href={~p"/admin"}>Admin</a></span>
      </p>
    </footer>
  </body>
</html>
