<!DOCTYPE html>
<html lang="en" style="scrollbar-gutter: stable;" data-theme={@settings.theme}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="csrf-token" content={get_csrf_token()} />
    <.live_title suffix={" Â· #{@settings.title}"}>
      <%= assigns[:page_title] || "Home" %>
    </.live_title>

    <.favicon />

    <link rel="authorization_endpoint" href={@auth_endpoint} />
    <link rel="token_endpoint" href={@token_endpoint} />
    <link rel="micropub" href={~p"/indie/micropub"} />

    <%= for identity <- @identities do %>
      <link rel="me" href={identity.url} />
    <% end %>

    <link rel="preconnect" href="https://rsms.me/" />
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />
    <link phx-track-static rel="stylesheet" href={~p"/assets/app.css"} />
    <script defer phx-track-static type="text/javascript" src={~p"/assets/public.js"}>
    </script>
    <script>
      if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.dataset["mode"] = "dark"
      } else {
        delete document.documentElement.dataset["mode"]
      }
    </script>
    <style>
      <%= @settings.custom_css %>
    </style>
  </head>
  <body class="bg-theme-background mx-3 md:mx-0">
    <header class="my-8 max-w-xl mx-auto block">
      <nav>
        <ul class="flex gap-3">
          <li>
            <a href="/">
              <.icon name="hero-home" /> Home
            </a>
          </li>
          <li>
            <a href="/about">
              <.icon name="hero-hand-raised" /> About
            </a>
          </li>
          <li class="flex-1"></li>
          <li>
            <.darkmode_toggle />
          </li>
        </ul>
      </nav>
    </header>

    <main>
      <%= @inner_content %>
    </main>

    <footer class="max-w-full mt-8 p-8 text-theme-base/75  bg-theme-background1">
      <section class="max-w-xl mx-auto">
        <p>
          <span>Served by Chiya v<%= Application.spec(:chiya, :vsn) %></span>
          <.dot />
          <span>Made by Inhji</span>
          <.dot />
          <span>Struggling to make a decent website since 2011</span>
        </p>

        <p>
          <%= for identity <- @public_identities do %>
            <span><a href={identity.url}><%= identity.name %></a></span>
            <.dot />
          <% end %>
          <span><a href={~p"/admin"}>Admin</a></span>
        </p>
      </section>
    </footer>
  </body>
</html>
